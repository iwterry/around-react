(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{15:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(7),c=a.n(r),o=(a(15),a(10)),s=a(3),l=a(2),u=i.a.createContext(),d=a.p+"static/media/header-vector.70737bb4.svg",p=a(0);var f=function(e){return Object(p.jsx)("header",{className:"header",children:Object(p.jsx)("img",{src:d,alt:"Around The U.S.",className:"header__vector"})})};var m=function(e){var t=e.card,a=e.onCardSelect,n=e.onCardLike,r=e.onCardDelete,c=i.a.useContext(u),o=t.likes.length,s=t.owner._id===c._id,l=t.likes.some((function(e){return e._id===c._id})),d="location__delete-btn"+(s?" location__delete-btn_active":""),f="location__like-btn"+(l?" location__like-btn_active":"");return Object(p.jsxs)("li",{className:"location",children:[Object(p.jsx)("button",{type:"button","aria-label":"Delete",className:d,onClick:function(){r(t._id)}}),Object(p.jsx)("img",{src:t.link,alt:t.name,className:"location__image",onClick:function(){a(t._id,t.name,t.link)}}),Object(p.jsxs)("div",{className:"location__content-wrapper",children:[Object(p.jsx)("h2",{className:"location__name",children:t.name}),Object(p.jsxs)("div",{className:"location__likes-wrapper",children:[Object(p.jsx)("button",{type:"button","aria-label":"Like",className:f,onClick:function(){n(t._id,l)}}),Object(p.jsx)("p",{className:"location__num-likes",children:o})]})]})]})};var j=function(e){var t=e.onEditAvatar,a=e.onAddPlace,n=e.onEditProfile,r=e.onCardSelect,c=e.onCardLike,o=e.onCardDelete,s=e.cards,l=i.a.useContext(u);return Object(p.jsxs)("main",{className:"main-content",children:[Object(p.jsxs)("section",{className:"profile",children:[Object(p.jsxs)("div",{className:"profile__avatar-wrapper",children:[Object(p.jsx)("img",{src:l.avatar,alt:"profile avatar",className:"profile__avatar"}),Object(p.jsx)("div",{className:"profile__avatar-overlay",onClick:t})]}),Object(p.jsxs)("div",{className:"profile__info",children:[Object(p.jsx)("h1",{className:"profile__name",children:l.name}),Object(p.jsx)("button",{type:"button","aria-label":"Edit",className:"profile__edit-btn",onClick:n}),Object(p.jsx)("p",{className:"profile__self-description",children:l.about})]}),Object(p.jsx)("button",{type:"button","aria-label":"Add location",className:"profile__add-btn",onClick:a})]}),Object(p.jsx)("section",{className:"locations",children:Object(p.jsx)("ul",{className:"locations__collection",children:s.map((function(e){var t=e.name,a=e.link,n=e.likes,i=e._id,s=e.owner;return Object(p.jsx)(m,{card:{name:t,link:a,likes:n,_id:i,owner:s},onCardSelect:r,onCardLike:c,onCardDelete:o},i)}))})})]})};var b=function(e){return Object(p.jsx)("footer",{className:"footer",children:Object(p.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Around The U.S."})})};var _=function(e){var t=e.name,a=e.children,n=e.isOpen,i=e.onClose,r=e.additionalCssClassesStr,c=void 0===r?"":r,o="overlay_opened";return Object(p.jsx)("div",{className:"overlay ".concat(c," ").concat(n?o:""),onClick:function(e){e.target.classList.contains(o)&&i()},children:Object(p.jsxs)("div",{className:"overlay__wrapper",children:[Object(p.jsx)("button",{type:"button","aria-label":"Close",className:"overlay__close-btn overlay__close-btn_type_".concat(t),onClick:i}),a]})})};var h=function(e){var t=e.card,a=e.onClose;return Object(p.jsx)(_,{name:"image-popup",isOpen:null!=t._id,onClose:a,additionalCssClassesStr:"overlay_dark",children:Object(p.jsxs)("figure",{className:"image-popup",children:[Object(p.jsx)("img",{src:t.link,alt:t.name,className:"image-popup__image"}),Object(p.jsx)("figcaption",{className:"image-popup__title",children:t.name})]})})};function v(e){console.log("Error: ".concat(e))}function O(e,t){var a=Object(s.a)({},e);return t.validity.valid?delete a[t.name]:a[t.name]=t.validationMessage,a}function x(e,t,a){var n="project-form__input-error";return n+" ".concat(n,"_field_").concat(t)+(null!=e[t]&&a?" ".concat(n,"_active"):"")}var g=function(e){var t=e.name,a=e.title,n=e.children,i=e.isOpen,r=e.onClose,c=e.onSubmit,o=e.isSubmitBtnDisabled,s=e.submitBtnText,l="project-form__submit-btn project-form__submit-btn_type_".concat(t)+(o?" project-form__submit-btn_disabled":"");return Object(p.jsx)(_,{name:t,isOpen:i,onClose:r,children:Object(p.jsxs)("form",{name:t,className:"project-form project-form_type_".concat(t),onSubmit:c,noValidate:!0,children:[Object(p.jsx)("h3",{className:"project-form__title project-form__title_type_".concat(t),children:a}),n,Object(p.jsx)("button",{type:"submit",className:l,disabled:o,children:s||"Submit"})]})})};var C=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,r=e.isUpdatingProfile,c=i.a.useState(""),o=Object(l.a)(c,2),s=o[0],d=o[1],f=i.a.useState(""),m=Object(l.a)(f,2),j=m[0],b=m[1],_=i.a.useState({}),h=Object(l.a)(_,2),v=h[0],C=h[1],y=i.a.useState(!1),N=Object(l.a)(y,2),k=N[0],S=N[1],P=i.a.useContext(u),w="profile-name",D="profile-description",B=x(v,w,t),A=x(v,D,t);function E(){var e=s.length<2||s.length>40||j.length<2||j.length>200;S(r||e||!t)}function T(e){var t=e.target;switch(t.name){case w:d(t.value);break;case D:b(t.value)}C(O(v,t))}function U(e){var t=e.target;C(O(v,t)),E()}return i.a.useEffect((function(){d(P.name),b(P.about)}),[P]),i.a.useEffect((function(){E()}),[s,j,r,t]),Object(p.jsxs)(g,{name:"profile-edit",title:"Edit profile",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n(s,j)},isSubmitBtnDisabled:k,submitBtnText:r?"Saving":"Save",children:[Object(p.jsxs)("div",{className:"project-form__field-wrapper project-form__field-wrapper_form_profile-edit",children:[Object(p.jsx)("input",{type:"text","aria-label":"Name",name:w,className:"project-form__input project-form__input_type_profile-edit-field",placeholder:"Name",minLength:2,maxLength:40,value:s,onChange:T,onBlur:U,required:!0}),Object(p.jsx)("p",{className:B,children:v[w]})]}),Object(p.jsxs)("div",{className:"project-form__field-wrapper project-form__field-wrapper_form_profile-edit",children:[Object(p.jsx)("input",{type:"text","aria-label":"About me",name:D,className:"project-form__input project-form__input_type_profile-edit-field",placeholder:"About me",minLength:2,maxLength:200,value:j,onChange:T,onBlur:U,required:!0}),Object(p.jsx)("p",{className:A,children:v[D]})]})]})};var y=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,r=e.isUpdatingAvatar,c=i.a.useState(""),o=Object(l.a)(c,2),s=o[0],u=o[1],d=i.a.useState({}),f=Object(l.a)(d,2),m=f[0],j=f[1],b=i.a.useState(!1),_=Object(l.a)(b,2),h=_[0],v=_[1],C="profile-avatar",y=x(m,C,t),N=m.hasOwnProperty(C),k=!h||r||N||!t;function S(e){j(O(m,e)),u(e.value)}return console.log("rendered"),Object(p.jsx)(g,{name:"profile-img-change",title:"Change profile picture",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n(s),u("")},isSubmitBtnDisabled:k,submitBtnText:r?"Saving":"Save",children:Object(p.jsxs)("div",{className:"project-form__field-wrapper project-form__field-wrapper_form_profile-img-change",children:[Object(p.jsx)("input",{type:"url","aria-label":"Avatar link",name:C,className:"project-form__input project-form__input_type_profile-img-change-field",placeholder:"Avatar link",value:s,onChange:function(e){var t=e.target;u(t.value),S(t),v(!0)},onBlur:function(e){S(e.target)},required:!0}),Object(p.jsx)("p",{className:y,children:m["profile-avatar"]})]})})};var N=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,r=e.isCreatingPlace,c=i.a.useState(""),o=Object(l.a)(c,2),s=o[0],u=o[1],d=i.a.useState(""),f=Object(l.a)(d,2),m=f[0],j=f[1],b=i.a.useState({}),_=Object(l.a)(b,2),h=_[0],v=_[1],C=i.a.useState(!1),y=Object(l.a)(C,2),N=y[0],k=y[1],S="location-title",P="location-link",w=x(h,S,t),D=x(h,P,t),B=h.hasOwnProperty(S)||h.hasOwnProperty(P),A=!N||r||B||!t;function E(e){var t=e.target;switch(t.name){case S:u(t.value);break;case P:j(t.value)}k(!0)}function T(e){!function(e){v(O(h,e))}(e.target)}return Object(p.jsxs)(g,{name:"location-create",title:"New place",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n(s,m),u(""),j("")},isSubmitBtnDisabled:A,submitBtnText:r?"Saving":"Save",children:[Object(p.jsxs)("div",{className:"project-form__field-wrapper project-form__field-wrapper_form_location-create",children:[Object(p.jsx)("input",{type:"text","aria-label":"Title",name:S,className:"project-form__input project-form__input_type_location-create-field",placeholder:"Title",minLength:"2",maxLength:"30",value:s,onChange:E,onBlur:T,required:!0}),Object(p.jsx)("p",{className:w,children:h[S]})]}),Object(p.jsxs)("div",{className:"project-form__field-wrapper project-form__field-wrapper_form_location-create",children:[Object(p.jsx)("input",{type:"url","aria-label":"Image link",name:P,className:"project-form__input project-form__input_type_location-create-field",placeholder:"Image link",value:m,onChange:E,onBlur:T,required:!0}),Object(p.jsx)("p",{className:D,children:h[P]})]})]})};var k=function(e){var t=e.isOpen,a=e.onClose,n=e.onConfirmation,i=e.isDeletingAfterConfirming;return Object(p.jsx)(g,{name:"confirmation-prompt",title:"Are you sure?",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n()},isSubmitBtnDisabled:i||!t,submitBtnText:"Yes"})},S=a(8),P=a(9),w=new(function(){function e(t){var a=t.headers;Object(S.a)(this,e),this._baseUrl="https://around.nomoreparties.co/v1/group-8",this._headers=a}return Object(P.a)(e,[{key:"getInitialCards",value:function(){return this._fetchData({relativePathFromBase:"cards"})}},{key:"getUserProfile",value:function(){return this._fetchData({relativePathFromBase:"users/me"})}},{key:"createCard",value:function(e,t){return this._fetchData({relativePathFromBase:"cards",method:"POST",additionalHeaderProps:{"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})})}},{key:"updateUserProfile",value:function(e,t){return this._fetchData({relativePathFromBase:"users/me",method:"PATCH",additionalHeaderProps:{"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})})}},{key:"deleteCard",value:function(e){return this._fetchData({relativePathFromBase:"cards/".concat(e),method:"DELETE"})}},{key:"updateUserAvatar",value:function(e){return this._fetchData({relativePathFromBase:"users/me/avatar",method:"PATCH",additionalHeaderProps:{"Content-Type":"application/json"},body:JSON.stringify({avatar:e})})}},{key:"updateCardLikes",value:function(e,t){return this._fetchData({relativePathFromBase:"cards/likes/".concat(e),method:t?"PUT":"DELETE"})}},{key:"_fetchData",value:function(e){var t=e.relativePathFromBase,a=e.method,n=void 0===a?"GET":a,i=e.additionalHeaderProps,r=void 0===i?{}:i,c=e.body,o=void 0===c?null:c,l={method:n,headers:Object(s.a)(Object(s.a)({},this._headers),r)};null!==o&&(l.body=o);var u="".concat(this._baseUrl,"/").concat(t);return fetch(u,l).then((function(e){return e.ok?e.json():Promise.reject(e.status)}))}}]),e}())({headers:{authorization:"f9c51bc0-ecec-42b1-bdb4-bcfabdba3e4f"}}),D=a.p+"static/media/profile-avatar.5a8c9959.jpg";var B=function(){var e=i.a.useState(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],r=i.a.useState(!1),c=Object(l.a)(r,2),d=c[0],m=c[1],_=i.a.useState(!1),O=Object(l.a)(_,2),x=O[0],g=O[1],S=i.a.useState({_id:null,link:"#",name:""}),P=Object(l.a)(S,2),B=P[0],A=P[1],E=i.a.useState({name:"Jacques Cousteau",about:"Explorer",avatar:D,_id:null}),T=Object(l.a)(E,2),U=T[0],L=T[1],F=i.a.useState([]),q=Object(l.a)(F,2),H=q[0],I=q[1],J=i.a.useState(null),M=Object(l.a)(J,2),z=M[0],G=M[1],V=i.a.useState(!1),Y=Object(l.a)(V,2),K=Y[0],Q=Y[1],R=i.a.useState(!1),W=Object(l.a)(R,2),X=W[0],Z=W[1],$=i.a.useState(!1),ee=Object(l.a)($,2),te=ee[0],ae=ee[1],ne=i.a.useState(!1),ie=Object(l.a)(ne,2),re=ie[0],ce=ie[1],oe=x||a||d||z||B._id;function se(){g(!1),n(!1),m(!1),G(null),A(Object(s.a)(Object(s.a)({},B),{},{_id:null}))}function le(e){"Escape"===e.key&&se()}return i.a.useEffect((function(){oe?document.addEventListener("keydown",le):document.removeEventListener("keydown",le)}),[oe]),i.a.useEffect((function(){w.getUserProfile().then(L).catch(v)}),[]),i.a.useEffect((function(){w.getInitialCards().then(I).catch(v)}),[]),Object(p.jsx)(u.Provider,{value:U,children:Object(p.jsxs)("div",{className:"page",children:[Object(p.jsx)(f,{}),Object(p.jsx)(j,{onEditAvatar:function(){g(!0)},onEditProfile:function(){n(!0)},onAddPlace:function(){m(!0)},onCardDelete:function(e){G(e)},onCardSelect:function(e,t,a){A({_id:e,name:t,link:a})},onCardLike:function(e,t){w.updateCardLikes(e,!t).then((function(t){var a=H.map((function(a){return a._id===e?t:a}));I(a)})).catch(v)},cards:H}),Object(p.jsx)(b,{}),Object(p.jsx)(C,{isOpen:a,onClose:se,onUpdateUser:function(e,t){Z(!0),w.updateUserProfile(e,t).then(L).catch(v).finally((function(){se(),Z(!1)}))},isUpdatingProfile:X}),Object(p.jsx)(N,{isOpen:d,onClose:se,onAddPlace:function(e,t){ae(!0),w.createCard(e,t).then((function(e){return I([e].concat(Object(o.a)(H)))})).catch(v).finally((function(){se(),ae(!1)}))},isCreatingPlace:te}),Object(p.jsx)(k,{isOpen:null!==z,onClose:se,onConfirmation:function(){ce(!0),w.deleteCard(z).then((function(e){console.log("returned:",e);var t=H.filter((function(e){return e._id!==z}));I(t)})).catch(v).finally((function(){se(),ce(!1)}))},isDeletingAfterConfirming:re}),Object(p.jsx)(y,{isOpen:x,onClose:se,onUpdateAvatar:function(e){Q(!0),w.updateUserAvatar(e).then(L).catch(v).finally((function(){se(),Q(!1)}))},isUpdatingAvatar:K}),Object(p.jsx)(h,{card:B,onClose:se})]})})},A=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,18)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),n(e),i(e),r(e),c(e)}))};c.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(B,{})}),document.getElementById("root")),A()}},[[17,1,2]]]);
//# sourceMappingURL=main.5b025cf4.chunk.js.map